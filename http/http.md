# HTTP

## 简介

> 超文本传输协议（HTTP，HyperText Transfer Protocol)是互联网上应用最为广泛的一种网络协议。所有的WWW文件都必须遵守这个标准。设计HTTP最初的目的是为了提供一种发布和接收HTML页面的方法。

HTTP是web联网的基础，也是手机联网常用的协议之一，HTTP是建立在TCP协议之上的一种应用

HTTP连接最显著的特点就是客户端发送的每次请求都需要服务器回送响应，在请求结束后，会主动释放连接。从建立连接到关闭连接的过程称为“一次连接”

- 在HTTP1.0中，客户端的每次请求都要建立一次单独的连接，在处理完本次请求后，就自动释放连接。
- 在HTTP1.1中则可以再一次连接中处理多个请求，并且多个请求可以重叠进行，不需要等待一个请求结束后再发送下一个请求。

### http1.0 和 http1.1 的区别

1. HTTP1.0 需要使用keep-alive参数来告知服务器端要建立一个长连接，而HTTP1.1默认支持长连接
2. 在HTTP1.0中主要使用header里的if-Modified0Since，Expires来作为缓存判断的标准，HTTP1.1则引入了更多的缓存控制策略例如Entity-tag，if-Unmodified-Since，if-Match，If-None-Match更多可供选择的缓存投来控制缓存策略
3. 在HTTP1.1中新增了24个错误状态响应码，如409（Conflict）表示请求的资源与资源当前的状态发生冲突；410（Gone）表示服务器上的某个资源被永久性的删除
4. HTTP1.1支持只发送header信息（不带任何body信息），如果服务器认为客户端有权限请求服务器，则返回100，否则返回401.客户端如果接收到了100，才开始把请求body发送到服务器。这样当服务器返回401的时候，客户端就可以不用发送请求body，节约了带宽
5. Host头处理，在HTTP1.0中认为每台服务器都绑定一个唯一的IP地址，因此，请求消息中的URL并没有传递主机名（hostname）。但随着虚拟主机的发展，在一台物理服务器上可以存在多个虚拟主机，并且它们共享一个IP地址。HTTP1.1的请求消息和响应消息都应支持Host头域，且请求消息中如果没有Host头域会报一个错误（400 Bad Request）

### http1.1 和http2.0 的区别

1. HTTP2.0 使用了多路复用的技术，做到同一个连接并发处理多个请求，而且并发请求的数量比HTTP1.1大了几个数量级。当然HTTP1.1也可以多建立几个TCP连接，来支持处理更多的并发的请求，但是创建TCP连接本身也是有开销的。

2. HTTP1.1不支持header数据的压缩，HTTP2.0使用HPACK算法对header的数据进行压缩，这样数据体积变小了，在网络上传输就会更快。

3. 当我们对支持HTTP2.0的web server请求数据的时候，服务器就顺便把一些客户端需要的资源一起推送到客户端，免得客户端再次创建连接发送请求到服务器获取。这种方式非常适合加载静态资源。

   

### HTTP 和 HTTPS的区别

http是超文本传输协议，信息是明文传输，https则是具有安全性的ssl加密传输协议。http和https使用的是完全不同的连接方式用的端口也不一样，http（80） https（443）。http的网络连接很简单，是无状态的。https协议是由SSL+HTTP协议构建的可进行加密传输、身份认证的网络协议，要比http协议安全。

# TCP

## TCP连接

> 手机能够使用联网功能是因为手机底层实现了TCP/IP协议，可以使手机终端通过无线网络建立TCP连接。TCP协议可以对上层网络提供接口，使上层网络数据的传输建立在“无差别”的网络之上。

建立起一个TCP连接需要经过“三次握手”

- 第一次握手：客户端发送syn（syn=j）包到服务器，并进入到SYN_SEND状态，等待服务器确认；
- 第二次握手：服务器收到syn包，必须确认客户的SYN（ack=j+1），同时也发送一个SYN包，即SYN+ACK包，此时服务器进入SYN_RECV状态
- 第三次握手：客户端收到服务器的SYN+ACK包，向服务器发送确认包ACK（ack=k+1），此包发送完毕，客户端和服务器进入ESTABLISHED，完成三次握手

握手过程中传送的包里不包含数据，三次握手完毕后，客户端与服务器才正式开始传送数据。理想状态下，TCP连接一旦建立，在通信双方中的任何一方主动关闭连接之前，TCP连接都将一直被保持下去。断开连接时服务器和客户端均可以主动断开TCP连接的请求，断开过程需要经过”四次握手“